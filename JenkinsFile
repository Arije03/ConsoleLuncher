pipeline {
  agent any 
    stages {
      stage('Checkout Codebase') {
        steps { 
           cleanWs()
           checkout scm: [$class: 'GitSCM',userRemoteConfigs: [[credentialsId: 'GitHubSShkey',url: 'git@github.com:mnorm88/multithreading-example-1.git']]] 
         } 
       } 
      
       stage('Build'){
            steps{
                sh 'mkdir lib'
                sh 'cd lib/ ; wget https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone/1.8.1/junit-platform-console-standalone-1.8.1.jar'
                javac -d target -cp target;"../lib/junit-platform-console-standalone-1.8.1.jar" src/test/java/FirstUnitTest.java
            }
        }

        stage('Test'){
            steps{
                java -jar "../lib/junit-platform-console-standalone-1.8.1.jar" -cp target -c FirstUnitTest
                junit 'src/reports/*-jupiter.xml'
            }
        }

        
    }

}
